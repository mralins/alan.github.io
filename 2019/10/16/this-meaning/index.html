<!DOCTYPE html><html lang="zh-CN"><head><meta name="generator" content="Hexo 3.9.0"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1"><meta name="author" content="Alan Li"><link rel="alternative" href="/atom.xml" title="Hi, I'm Alan" type="application/atom+xml"><link rel="icon" href="../../images/favicon.png"><title>js中this的使用及代表意义 - Hi, I'm Alan</title><link rel="stylesheet" href="/css/main.css"><link rel="stylesheet" href="/js/fancybox/jquery.fancybox.min.css"><!--[if lt IE 9]><script>(function(a,b){a="abbr article aside audio bdi canvas data datalist details dialog figcaption figure footer header hgroup main mark meter nav output progress section summary template time video".split(" ");for(b=a.length-1;b>=0;b--)document.createElement(a[b])})()</script><![endif]--><script src="/js/jquery-3.1.1.min.js"></script><script src="/js/fancybox/jquery.fancybox.min.js"></script></head><body style="opacity:0"><header class="head"><h1 class="head-title u-fl"><a href="/">Hi, I'm Alan</a></h1><nav class="head-nav u-fr"><ul class="head-nav__list"><li class="head-nav__item"><a class="head-nav__link" href="/introduction">简介</a></li><li class="head-nav__item"><a class="head-nav__link" href="/production">作品</a></li><li class="head-nav__item"><a class="head-nav__link" href="/designs">设计</a></li><li class="head-nav__item"><a class="head-nav__link" href="/archives">随笔</a></li><li class="head-nav__item"><a class="head-nav__link" href="/tags">标签</a></li></ul></nav></header><main class="main"><article class="post"><header class="post__head"><time class="post__time" datetime="2019-10-16T07:31:56.000Z">2019 - 10 - 16 15:31:56</time><h1 class="post__title"><a href="/2019/10/16/this-meaning/">js中this的使用及代表意义</a></h1><div class="post__main echo"><p>我们在js中经常看到this这个关键字，那么他是什么呢？它可以是全局对象、当前对象，也可以是任意对象，函数的调用方式决定了 this 的值。</p>
<h2 id="1-方法中的this。"><a href="#1-方法中的this。" class="headerlink" title="( 1 ) 方法中的this。"></a>( 1 ) 方法中的this。</h2><p>在对象方法中， this 指向调用它所在方法的对象。例如：</p>
<h3 id="示例："><a href="#示例：" class="headerlink" title="示例："></a>示例：</h3><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> information = &#123;</span><br><span class="line">  name: <span class="string">"alan"</span>,</span><br><span class="line">  age : <span class="string">"18"</span>,</span><br><span class="line">  all : <span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="keyword">this</span>.name + <span class="string">" "</span> + <span class="keyword">this</span>.age;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure>

<p>在这里，this 表示 information 对象。all 方法所属的对象就是 information。</p>
<h2 id="2-单独直接调用this"><a href="#2-单独直接调用this" class="headerlink" title="( 2 ) 单独直接调用this."></a>( 2 ) 单独直接调用this.</h2><p>单独使用 this，则它指向全局(Global)对象。例如：</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> name = <span class="keyword">this</span>;</span><br><span class="line">&amp;&amp;</span><br><span class="line"><span class="meta">"use strict"</span>;(严格模式)</span><br><span class="line"><span class="keyword">var</span> name = <span class="keyword">this</span>;</span><br></pre></td></tr></table></figure>

<h2 id="3-函数中调用this"><a href="#3-函数中调用this" class="headerlink" title="( 3 ) 函数中调用this."></a>( 3 ) 函数中调用this.</h2><p>在函数中，函数的所属者默认绑定到 this 上。例如：</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">information</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">  <span class="keyword">return</span> <span class="keyword">this</span>;</span><br><span class="line">&#125;</span><br><span class="line">&amp;&amp;</span><br><span class="line"><span class="meta">"use strict"</span>;(严格模式)</span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">information</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">  <span class="keyword">return</span> <span class="keyword">this</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h2 id="4-箭头函数调用this"><a href="#4-箭头函数调用this" class="headerlink" title="( 4 ) 箭头函数调用this."></a>( 4 ) 箭头函数调用this.</h2><p>ES6 新增了箭头函数，箭头函数不仅更加整洁，还对 this 的指向进行了改进。箭头函数会从作用域链的上一层继承 this。</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> obj = &#123;</span><br><span class="line">  y: <span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">      <span class="built_in">console</span>.log(<span class="keyword">this</span> === obj)</span><br><span class="line"></span><br><span class="line">      <span class="keyword">var</span> getX = <span class="function"><span class="params">()</span> =&gt;</span> &#123;</span><br><span class="line">          <span class="built_in">console</span>.log(<span class="keyword">this</span> === obj)</span><br><span class="line">      &#125;</span><br><span class="line">      getX()</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">obj.y() </span><br><span class="line"><span class="comment">// true</span></span><br><span class="line"><span class="comment">// true</span></span><br></pre></td></tr></table></figure>

<p>和普通函数不一样，箭头函数中的 this 指向了 obj，这是因为它从上一层的函数中继承了 this，你可以理解为箭头函数修正了 this 的指向。例如：</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> x = <span class="number">1</span></span><br><span class="line"><span class="keyword">var</span> obj = &#123;</span><br><span class="line">  x: <span class="number">2</span>,</span><br><span class="line">  y: <span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">      <span class="keyword">var</span> getX = <span class="function"><span class="params">()</span> =&gt;</span> &#123;</span><br><span class="line">           <span class="built_in">console</span>.log(<span class="keyword">this</span>.x)</span><br><span class="line">      &#125;</span><br><span class="line">      <span class="keyword">return</span> getX()</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">obj.y()            <span class="comment">// 2</span></span><br><span class="line"><span class="keyword">var</span> a = obj.y</span><br><span class="line">a()               <span class="comment">// 1</span></span><br></pre></td></tr></table></figure>

<p>obj.y() 在运行时，调用它的对象是 obj，所以 y 中的 this 指向 obj，y 中的箭头函数 getX 继承了 y 中的 this，所以结果是 2。如果我们先将 y 赋值给全局作用域中的变量 a，a 在运行时，y 中的 this 便指向了全局对象，所以得到的结果是 1（非严格模式）。</p>
<h2 id="5-js事件中调用this"><a href="#5-js事件中调用this" class="headerlink" title="( 5 ) js事件中调用this.　"></a>( 5 ) js事件中调用this.　</h2><p>this 指向了接收事件的 HTML 元素。例如：</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&lt;button onclick=<span class="string">"this.style.display='block'"</span>&gt;显示&lt;<span class="regexp">/button&gt;</span></span><br></pre></td></tr></table></figure>

<h2 id="6-使用call和apply"><a href="#6-使用call和apply" class="headerlink" title="( 6 ) 使用call和apply"></a>( 6 ) 使用call和apply</h2><p>改变 this 的指向，可以使用 call 或 apply 方法，它们都可以改变函数的调用对象。将一个对象作为第一个参数传给 call 或 apply，this 便会绑定到这个对象。如果第一个参数不传或者传 null 、undefined，默认 this 指向全局对象（非严格模式）或 undefined（严格模式）。</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> x = <span class="number">1</span>; </span><br><span class="line"><span class="keyword">var</span> obj = &#123; <span class="attr">x</span>: <span class="number">2</span> &#125; </span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">getX</span>(<span class="params"></span>) </span>&#123; </span><br><span class="line">    <span class="built_in">console</span>.log(<span class="keyword">this</span>.x) </span><br><span class="line">&#125; </span><br><span class="line"></span><br><span class="line">getX.call(obj) <span class="comment">// 2 </span></span><br><span class="line">getX.apply(obj) <span class="comment">// 2 </span></span><br><span class="line">getX.call() <span class="comment">// 1 </span></span><br><span class="line">getX.apply(<span class="literal">null</span>) <span class="comment">// 1 </span></span><br><span class="line">getX.call(<span class="literal">undefined</span>) <span class="comment">// 1</span></span><br></pre></td></tr></table></figure>

<p>使用 call 和 apply 时，如果给 this 传的不是对象，JavaScript 会使用相关构造函数将其转化为对象，比如传 number 类型，会进行 new Number() 操作，传 string 类型，会进行 new String() 操作。</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">demo</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">  <span class="built_in">console</span>.log(<span class="built_in">Object</span>.prototype.toString.call(<span class="keyword">this</span>))</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">demo.call(<span class="string">'hello'</span>)      <span class="comment">// [object String]</span></span><br><span class="line">demo.apply(<span class="number">5</span>)           <span class="comment">// [object Number]</span></span><br></pre></td></tr></table></figure>

<p>call 和 apply 的区别在于，call 的第二个及后续参数是一个参数列表，apply 的第二个参数是数组。参数列表和参数数组都将作为函数的参数进行执行。</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> x = <span class="number">1</span></span><br><span class="line"><span class="keyword">var</span> obj = &#123;</span><br><span class="line">  x: <span class="number">2</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">getSum</span>(<span class="params">y, z</span>) </span>&#123;</span><br><span class="line">  <span class="built_in">console</span>.log(<span class="keyword">this</span>.x + y + z)</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">getSum.call(obj, <span class="number">3</span>, <span class="number">4</span>)       <span class="comment">// 9</span></span><br><span class="line">getSum.apply(obj, [<span class="number">3</span>, <span class="number">4</span>])    <span class="comment">// 9</span></span><br></pre></td></tr></table></figure>

<h2 id="7-bind方法调用this"><a href="#7-bind方法调用this" class="headerlink" title="( 7 ) bind方法调用this."></a>( 7 ) bind方法调用this.</h2><p>bind 方法会创建一个新函数，新函数的 this 会永久的指向 bind 传入的第一个参数。例如:</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> x = <span class="number">1</span></span><br><span class="line"><span class="keyword">var</span> obj_1 = &#123;</span><br><span class="line">  x: <span class="number">2</span></span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">var</span> obj_2 = &#123;</span><br><span class="line">  x: <span class="number">3</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">getX</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">  <span class="built_in">console</span>.log(<span class="keyword">this</span>.x)</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">var</span> a = getX.bind(obj_1)</span><br><span class="line"><span class="keyword">var</span> b = a.bind(obj_2)</span><br><span class="line"></span><br><span class="line">getX()           <span class="comment">// 1</span></span><br><span class="line">a()              <span class="comment">// 2</span></span><br><span class="line">b()              <span class="comment">// 2</span></span><br><span class="line">a.call(obj_2)    <span class="comment">// 2</span></span><br></pre></td></tr></table></figure>

<p>虽然我们尝试给函数 a 重新指定 this 的指向，但是它依旧指向第一次 bind 传入的对象，即使是使用 call 或 apply 方法也不能改变这一事实。</p>
<p>this 是 JavaScript 中非常重要的关键字，不同的运行环境和调用方式都会对 this 产生影响。理解它能让我们更熟练地使用这门语言！</p>
<center>---- 感谢观看 :thank you: ----</center></div></header><footer class="post__foot u-cf"><ul class="post__tag u-fl"><li class="post__tag__item"><a class="post__tag__link" href="/tags/js/">js</a></li><li class="post__tag__item"><a class="post__tag__link" href="/tags/this/">this</a></li><li class="post__tag__item"><a class="post__tag__link" href="/tags/call/">call</a></li><li class="post__tag__item"><a class="post__tag__link" href="/tags/apply/">apply</a></li></ul></footer></article><canvas id="canvas"></canvas></main><footer class="foot"><div class="foot-copy">&copy; 2016 - 2019 Alan Li</div></footer><script src="/js/scroller.js"></script><script src="/js/main.js"></script><script src="/js/canvas.js"></script></body></html>